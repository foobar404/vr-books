<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XR Book Reader</title>

    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>

    <!-- A-Frame Environment Component -->
    <script
        src="https://cdn.jsdelivr.net/gh/supermedium/aframe-environment-component@master/dist/aframe-environment-component.min.js"></script>

    <!-- JSZip for EPUB parsing -->
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    
    <!-- Epub.js for book rendering -->
    <script src="https://cdn.jsdelivr.net/npm/epubjs@0.3.93/dist/epub.min.js"></script>

    <!-- Components -->
    <script src="./components/environment-controller.js" type="module"></script>
    <script src="./components/wasd-plus.js" type="module"></script>
    <script src="./components/object-grab.js" type="module"></script>
    <script src="./components/world-grab.js" type="module"></script>
    <script src="./components/vr-book.js" type="module"></script>
    <script src="./components/vr-library.js" type="module"></script>
    <script src="./components/control-panel.js" type="module"></script>

    <!-- Main app -->
    <script src="./index.js" type="module"></script>
</head>

<body>
    <a-scene environment-controller>
        <!-- Camera -->
        <a-entity id="camera-rig" position="0 1.6 0">
            <a-camera id="camera" look-controls="pointerLockEnabled: true;" wasd-plus="acceleration: 10">
                <a-entity cursor="fuse: false; rayOrigin: mouse" 
                    raycaster="objects: .grabbable; far: 20"
                    material="color: white; shader: flat" 
                    position="0 0 -0.5">
                </a-entity>
            </a-camera>

            <!-- Left Hand Controller -->
            <a-entity id="left-hand" 
                oculus-touch-controls="hand: left; model: true"
                laser-controls="hand: left; color: #ff0066"
                raycaster="objects: .grabbable; far: 10"
                object-grab
                world-grab>
            </a-entity>

            <!-- Right Hand Controller -->
            <a-entity 
                id="right-hand" 
                oculus-touch-controls="hand: right; model: true"
                laser-controls="hand: right; color: #0066ff"
                raycaster="objects: .grabbable; far: 10"
                object-grab
                world-grab>
            </a-entity>

            <!-- Virtual Bookshelf (child of camera rig) -->
            <a-entity 
                id="bookshelf" 
                position="0 2 -0.8" 
                vr-library="booksPath='/books/manifest.json'">
            </a-entity>

            <a-entity control-panel></a-entity>
        </a-entity>

        <!-- Lights -->
        <a-light id="ambient-light" type="ambient" intensity="0.5"></a-light>
        <a-light id="directional-light" type="directional" position="2 4 2" intensity="0.8"></a-light>
    </a-scene>
</body>

</html>